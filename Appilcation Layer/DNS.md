DNS 서버는 인터넷에서 도메인 이름을 IP 주소로 변환해주는 중요한 역할을 하는 시스템입니다. 우리는 웹사이트를 방문할 때 사람이 이해하기 쉬운 도메인 이름(예: `educative.io`)을 사용합니다. 그러나 컴퓨터는 이 이름을 이해할 수 없기 때문에, 해당 도메인 이름을 컴퓨터가 이해할 수 있는 **IP 주소**(예: `104.20.7.183`)로 변환해야 합니다. 이 과정에서 **DNS 서버**가 핵심적인 역할을 합니다. DNS는 분산된 데이터베이스 형태로 구성되어 있으며, 여러 종류의 DNS 서버가 협력하여 도메인 이름을 효율적으로 처리합니다. 여기서는 DNS 서버의 구조와 역할에 대해 자세히 설명드리겠습니다.

### DNS 서버의 종류와 역할
DNS 서버는 여러 가지 종류로 나눌 수 있으며, 각각 고유의 역할을 담당합니다. 주요 DNS 서버는 다음과 같습니다:

#### 1. **루트 DNS 서버 (Root DNS Server)**
- **계층 구조의 최상위**에 위치하며, 모든 DNS 쿼리가 처음으로 접근하는 서버입니다.
- 사용자가 도메인 이름을 요청할 때, 루트 DNS 서버는 해당 도메인의 **최상위 도메인(TLD) 서버**로 연결해 줍니다.
- 예를 들어, 사용자가 `educative.io`를 요청할 경우, 루트 DNS 서버는 `.io`라는 TLD 서버의 IP 주소를 반환합니다.
- 전 세계에는 약 **1017개의 루트 서버 인스턴스**가 존재하며, **12개의 조직**에서 운영하고 있습니다.

#### 2. **최상위 도메인 서버 (Top-level Domain, TLD Server)**
- **최상위 도메인(TLD)**에 대한 정보를 관리하는 서버입니다. 최상위 도메인은 주로 `.com`, `.net`, `.org`, `.edu`, 국가 도메인(예: `.kr`, `.us`) 등이 있습니다.
- 루트 DNS 서버로부터 TLD 서버로 연결되면, TLD 서버는 해당 도메인의 **권한 있는 DNS 서버**로 연결해 줍니다.
- 예를 들어, `educative.io` 도메인을 요청하면 `.io` TLD 서버가 `educative.io`의 권한 있는 DNS 서버 정보를 제공합니다.

#### 3. **권한 있는 서버 (Authoritative Name Server)**
- 특정 도메인에 대한 최종 정보를 **관리하고 저장**하는 서버입니다.
- 예를 들어, `educative.io`에 대한 IP 주소는 `educative.io`의 권한 있는 서버에 저장되어 있으며, 클라이언트의 요청에 대한 최종 IP 주소를 반환합니다.
- 만약 해당 도메인이 **서브 도메인**을 포함하고 있다면, 서브 도메인에 대한 정보도 가지고 있습니다.
  - 예를 들어, `cs.stanford.edu`라는 서브 도메인에 대한 정보는 `stanford.edu`의 권한 있는 서버에 의해 관리될 수 있습니다.

#### 4. **로컬 DNS 서버 (Local DNS Server)**
- **클라이언트가 도메인 이름을 요청**할 때 가장 먼저 접근하는 서버입니다.
- 일반적으로 **ISP(인터넷 서비스 제공자)**에서 운영하며, 자주 방문하는 도메인에 대한 정보를 캐싱하고 있습니다.
- 로컬 DNS 서버는 먼저 **자신의 캐시**에서 정보가 있는지 확인하고, 없을 경우 루트 서버로 쿼리를 전송합니다.
- 로컬 DNS 서버는 특정 기간 동안 도메인 정보(IP 주소)를 저장하여 자주 사용되는 도메인에 대해 더 빠른 응답을 제공할 수 있습니다.

#### 5. **로컬 DNS 캐시(Local DNS Cache)**
- 로컬 캐시는 **사용자의 운영체제나 브라우저**에 의해 관리됩니다.
- 자주 방문하는 웹사이트의 도메인 정보를 캐시해두어, **반복적인 DNS 조회를 줄이고** 더 빠른 응답을 제공할 수 있습니다.
- 로컬 캐시에 도메인 정보가 없을 경우, **로컬 DNS 서버**로 쿼리를 전송하게 됩니다.

### DNS 쿼리 과정
DNS를 통해 도메인 이름이 IP 주소로 변환되는 과정은 **계층적**으로 이루어집니다. 다음은 일반적인 DNS 쿼리 과정입니다:

1. 사용자가 **브라우저**에 도메인 이름(예: `educative.io`)을 입력합니다.
2. **로컬 캐시**에서 해당 도메인의 IP 주소가 있는지 확인합니다.
3. 로컬 캐시에 정보가 없으면, **로컬 DNS 서버**에 쿼리를 보냅니다.
4. 로컬 DNS 서버에 정보가 없다면, **루트 DNS 서버**에 쿼리를 보냅니다.
5. 루트 DNS 서버는 **TLD 서버**로 연결하며, TLD 서버는 도메인의 **권한 있는 서버**로 쿼리를 전달합니다.
6. **권한 있는 서버**에서 최종 IP 주소를 받아와, 클라이언트에 응답합니다.
7. 클라이언트는 받은 IP 주소를 통해 해당 서버에 접속합니다.

이와 같은 계층적 쿼리 과정을 통해 도메인 이름이 IP 주소로 변환되며, 사용자는 원하는 웹사이트에 접속할 수 있게 됩니다.

### DNS 도구: nslookup과 dig
DNS 쿼리와 관련하여 유용하게 사용할 수 있는 명령줄 도구로는 `nslookup`과 `dig`가 있습니다.

1. **nslookup**
   - `nslookup`은 특정 도메인에 대한 DNS 정보를 조회할 수 있는 도구입니다.
   - 간단히 도메인 이름을 입력하여 해당 도메인의 **IP 주소나 메일 서버** 정보를 확인할 수 있습니다.
   - 예를 들어, `nslookup educative.io`를 실행하면 `educative.io`에 해당하는 IP 주소를 반환합니다.

2. **dig**
   - `dig`는 **Domain Information Groper**의 약자로, DNS 서버에 대한 정보를 더 **세부적으로** 확인할 수 있는 도구입니다.
   - `nslookup`보다 더 많은 정보를 제공하며, 쿼리 과정에서 실제로 오가는 **DNS 메시지**를 확인할 수 있습니다.
   - 예를 들어, `dig educative.io`를 실행하면 쿼리, 응답, TTL, 권한 있는 서버 정보 등 여러 가지 세부 정보를 출력합니다.

### DNS 보안과 프라이버시
- **ISP(인터넷 서비스 제공자)**는 사용자가 어떤 웹사이트를 방문하는지를 알 수 있는 능력을 가지고 있습니다. 로컬 DNS 서버에서 사용자의 요청이 기록되기 때문입니다.
- 이러한 보안 문제가 우려되는 경우, **공용 DNS 서버**(예: 구글의 8.8.8.8 또는 클라우드플레어의 1.1.1.1)를 사용할 수 있습니다. 이를 통해 더 나은 **프라이버시**를 유지할 수 있습니다.

### 요약
- **DNS 서버**는 도메인 이름을 IP 주소로 변환하여 인터넷에서 웹사이트에 접속할 수 있도록 돕는 중요한 시스템입니다.
- DNS는 여러 서버가 계층적으로 구성되어 있어 한 서버에 문제가 발생하더라도 전체 시스템이 영향을 받지 않도록 설계되었습니다.
- **루트 DNS 서버, TLD 서버, 권한 있는 서버, 로컬 DNS 서버**는 각각의 역할을 통해 DNS 쿼리를 처리하며, 사용자는 이를 통해 인터넷을 편리하게 이용할 수 있습니다.
- **`nslookup`과 `dig`**와 같은 명령어를 사용하여 도메인에 대한 자세한 정보를 직접 조회하고 DNS의 동작 방식을 이해할 수 있습니다.