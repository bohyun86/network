### 계층적 아키텍처와 프로토콜 스택 (Layered Architectures & Protocol Stacks)

**계층적 아키텍처**는 컴퓨터 네트워크를 구성하는 방식 중 하나로, 복잡한 네트워크 시스템을 **여러 계층으로 나누어** 각 계층이 고유한 기능을 수행하게 함으로써 네트워크를 보다 **효율적이고 구조적으로** 관리할 수 있게 합니다. 이를 통해 네트워크의 각 구성 요소들이 효율적으로 협력하고 독립적으로 발전할 수 있게 됩니다.

---

### 계층적 아키텍처란?
**계층적 아키텍처**는 큰 복잡한 시스템을 보다 간단하게 다룰 수 있도록, **점차 높은 수준의 추상화**로 접근하는 방식입니다. 이렇게 시스템은 특정 작업을 수행하는 여러 **계층(layers)**으로 나뉘며, 각각의 계층이 고유한 역할을 맡습니다.

---

### 왜 계층을 사용할까?
계층적 구조는 시스템을 모듈화하여 **특정 부분을 독립적으로 다룰 수 있는 장점**을 제공합니다. 이렇게 하면 **버그를 식별**하거나 **구현 세부 사항**을 변경하는 것이 용이해집니다.

---

### 아날로지: 우편 (Post)
계층적 아키텍처를 이해하기 위해 **우편**을 보내는 과정을 예로 들어보겠습니다. 우편을 보내는 일반적인 단계는 다음과 같습니다:
1. 편지를 작성하고
2. 봉투에 넣고
3. 우표를 붙이고
4. 우체통에 넣습니다.

이 과정을 통해 **컴퓨터 네트워킹**에서 어떻게 계층이 적용되는지 이해할 수 있습니다.

---

### 계층은 서로 서비스를 제공한다: 수직 계층 구조 (Vertical Layers)
각 계층은 **상위 계층**에 서비스를 제공합니다. 그리고 상위 계층은 하위 계층이 **어떻게 서비스를 제공하는지**에 대해서는 신경 쓰지 않습니다. 이를 **추상화(abstraction)**라고 합니다. 이러한 방식으로 계층 간에는 **수직적인** 소통이 이루어집니다.

#### 우편의 수직 계층 구조
우편 예시에서는, 각 단계가 상위 단계에 서비스를 제공합니다. 예를 들어, **우체부**는 편지를 **보내는 사람**과 **받는 사람**에게 서비스를 제공합니다. 우체부는 우체통에서 편지를 수집하고 이를 목적지까지 배달합니다.

보내는 사람은 편지를 쓰고, 봉투에 넣고, 우표를 붙이고, 우체통에 넣기만 하면, 그 후의 과정(트럭, 기차, 항공 등으로의 운송)에 대해 알 필요가 없습니다. 이처럼, 네트워크의 각 계층도 상위 계층에서 요청한 작업이 **어떻게 수행되는지**에 대해 신경 쓰지 않습니다. 이러한 특성이 **추상화**입니다.

#### 네트워크의 수직 계층 구조
컴퓨터 네트워크에서도 계층이 서로를 서비스하는 방식으로 나뉘어 있습니다.  
- 예를 들어, 대부분의 **계층적 모델**에서 가장 상위에 있는 **애플리케이션 계층**은 최종 사용자가 사용하는 웹, 이메일 등의 **애플리케이션**이 위치한 곳입니다.
- **애플리케이션 계층**에서 시작된 데이터는 그 아래의 계층들을 통해 전달되어 목적지로 전송됩니다.

---

### 계층은 서로 평행하게 통신한다: 수평 계층 구조 (Horizontal Layers)
각 계층은 **발신 측**에서 **수신 측**의 동일한 계층과 **직접적인 통신**을 하는 것처럼 보입니다.

#### 우편의 수평 계층 구조
우편 예시에서는, **편지 작성자**와 **받는 사람**이 마치 직접적인 통신을 하는 것처럼 보입니다. 작성자는 편지를 작성하고, 수신자는 그 편지를 읽습니다. 이 과정에서 실제로는 많은 하위 계층에서 우편물이 전달되고 있지만, 편지 작성자와 수신자는 그 과정에 대해 알 필요가 없습니다. 마찬가지로, 우체국 간에도 평행한 소통이 이루어집니다. 예를 들어, 한 우체국에서 수집된 우편물이 다른 우체국으로 전달되는 방식입니다.

#### 네트워크의 수평 계층 구조
네트워크에서도 **애플리케이션 계층**에서 시작된 데이터가 **발신 시스템**에서 **수신 시스템**의 애플리케이션 계층으로 전달됩니다.
- 예를 들어, 한 컴퓨터의 **채팅 애플리케이션**이 다른 컴퓨터의 **채팅 애플리케이션**과 소통할 때, 이들 애플리케이션은 **직접적인 수평적 통신**을 하는 것처럼 보입니다. 이 과정에서 **하위 계층**에서 이루어지는 작업에 대해 애플리케이션 계층은 알 필요가 없습니다.

---

### 계층의 독립적 발전 (Independent Evolution of Layers)
각 계층은 **독립적으로 발전**할 수 있습니다.  
- **하위 계층**은 상위 계층에 필요한 서비스를 제공하고, 상위 계층은 이를 기반으로 다른 서비스를 만들어 낼 수 있습니다.
- 예를 들어, **애플리케이션 계층**은 이메일에서 첨부 파일을 지원하는 방식, 동적 웹, 인터랙티브 게임, 비디오 회의 등 새로운 기능을 추가할 수 있습니다. 이 모든 것들은 **하위 인프라**를 그대로 사용하면서 이루어집니다.

#### 우편의 독립적 발전
우편에서 보내는 항목은 꼭 **편지**일 필요는 없습니다.  
- **소포**일 수도 있고, **봉투**나 **상자**에 넣을 수 있습니다.  
- 우체국에 직접 가져갈 수도 있고, 우체통에 넣을 수도 있으며, 집에서 수거해 갈 수도 있습니다.
- 수신자도 **집**, **P.O. 박스**, **사무실** 등 다양한 방식으로 받을 수 있습니다.

#### 네트워크의 독립적 발전
**애플리케이션 계층**에서는 **MP3 파일**이나 **워드 문서** 등 다양한 형태의 데이터를 주고받을 수 있습니다.  
하위 계층의 동작 방식에 영향을 받지 않으면서, 새로운 기능이나 데이터를 추가할 수 있습니다.

---

### 캡슐화 & 디캡슐화 (Encapsulation & Decapsulation)
- 각 계층은 상위 계층에서 전달받은 메시지에 **자신의 헤더**를 추가합니다. 이 과정을 **캡슐화(encapsulation)**라고 합니다.
- 수신 측에서는 각 계층이 **헤더를 제거**하여 원래의 메시지를 전달하는데, 이를 **디캡슐화(decapsulation)**라고 합니다.
- 예를 들어, 편지의 경우, 작성된 내용에 봉투를 씌우고 주소를 붙이는 것이 **캡슐화**이고, 수신자가 이를 제거하고 내용을 확인하는 것이 **디캡슐화**입니다.

---

**계층적 아키텍처**는 네트워크의 **복잡성을 줄이고**, 각 계층이 독립적으로 관리되고 발전할 수 있도록 합니다. 이러한 구조를 통해 네트워크는 다양한 **프로토콜**과 **서비스**를 효율적으로 지원하며, 확장성과 유연성을 제공합니다.